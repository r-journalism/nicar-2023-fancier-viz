{
  "hash": "5a7fbd13e65cc3adbc48bee53ed09e57",
  "result": {
    "markdown": "---\ntitle: \"Automatic labels\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggrepel)\n\nstate_df <- read_csv(\"data/opioids_states.csv\")\n\nglimpse(state_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 918\nColumns: 9\n$ buyer_state <chr> \"AK\", \"AK\", \"AK\", \"AK\", \"AK\", \"AK\", \"AK\", \"AK\", \"AK\", \"AK\"…\n$ year        <dbl> 2006, 2006, 2007, 2007, 2008, 2008, 2009, 2009, 2010, 2010…\n$ pills       <dbl> 15667010, 15667010, 17272433, 17272433, 18707811, 18707811…\n$ state       <chr> \"Alaska\", \"Alaska\", \"Alaska\", \"Alaska\", \"Alaska\", \"Alaska\"…\n$ deaths      <dbl> 29, 29, 15, 15, 88, 88, 90, 90, 62, 62, 66, 66, 81, 81, 69…\n$ population  <dbl> 675302, 675302, 680300, 680300, 687455, 687455, 698895, 69…\n$ crude_rate  <chr> \"4.3\", \"4.3\", \"Unreliable\", \"Unreliable\", \"12.8\", \"12.8\", …\n$ type        <chr> \"death_per_1m\", \"pills_per_person\", \"death_per_1m\", \"pills…\n$ rate        <dbl> 42.9, 23.2, 22.0, 25.4, 128.0, 27.2, 128.8, 28.8, 87.3, 29…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_df_06 <-state_df %>% \n  filter(year==2006) %>% \n  pivot_wider(names_from=\"type\", values_from=\"rate\")\n\nglimpse(state_df_06)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 51\nColumns: 9\n$ buyer_state      <chr> \"AK\", \"AL\", \"AR\", \"AZ\", \"CA\", \"CO\", \"CT\", \"DC\", \"DE\",…\n$ year             <dbl> 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006, 2006,…\n$ pills            <dbl> 15667010, 174362638, 88505157, 177223504, 859369650, …\n$ state            <chr> \"Alaska\", \"Alabama\", \"Arkansas\", \"Arizona\", \"Californ…\n$ deaths           <dbl> 29, 124, 140, 459, 1511, 326, 224, 55, 37, 1223, 331,…\n$ population       <dbl> 675302, 4628981, 2821761, 6029141, 36021202, 4720423,…\n$ crude_rate       <chr> \"4.3\", \"2.7\", \"5.0\", \"7.6\", \"4.2\", \"6.9\", \"6.4\", \"9.6…\n$ death_per_1m     <dbl> 42.9, 26.8, 49.6, 76.1, 41.9, 69.1, 63.7, 96.4, 43.1,…\n$ pills_per_person <dbl> 23.2, 37.7, 31.4, 29.4, 23.9, 22.9, 22.5, 11.5, 33.5,…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(state_df_06, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(state_df_06, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  geom_text(aes(label=buyer_state), size=3) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(state_df_06, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  geom_text(aes(label=buyer_state), hjust=-.5, size=3) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(state_df_06, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  geom_text_repel(aes(label=buyer_state), size=3) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(state_df_06, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  geom_text_repel(data= . %>% \n                  mutate(new_label=ifelse(death_per_1m>120,\n                                        buyer_state, \"\")),\n                  aes(label=new_label), size=3) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_df_wide <-state_df %>% \n  #filter(year==2006) %>% \n  pivot_wider(names_from=\"type\", values_from=\"rate\")\n\nggplot(state_df_wide, aes(x=death_per_1m, y=pills_per_person)) +\n  geom_point() +\n  geom_text_repel(data= . %>% \n                  mutate(new_label=ifelse(death_per_1m>120,\n                                        buyer_state, \"\")),\n                  aes(label=new_label), size=3) +\n  facet_wrap(~year, ncol=2) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](textrepel_files/figure-html/unnamed-chunk-7-1.png){width=864}\n:::\n:::\n",
    "supporting": [
      "textrepel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}